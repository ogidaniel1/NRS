{% extends "base.html" %}

{% block title %}Edit User{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Edit User</h2>
    
    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mt-3">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <form method="POST">
       
        <!-- Level 1 Fields -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">Business Information</div>
            <div class="card-body">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="business_name">Business Name</label>
                        <input type="text" class="form-control" id="business_name" name="business_name" value="{{ user.business_name }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="business_address">Business Address</label>
                        <input type="text" class="form-control" id="business_address" name="business_address" value="{{ user.business_address }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="phone_number">Phone Number</label>
                        <input type="text" class="form-control" id="phone_number" name="phone_number" value="{{ user.phone_number }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="email">Email</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ user.email }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="state">State</label>
                        <input type="text" class="form-control" id="state" name="state" value="{{ user.state }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="password">Password</label>
                        <input type="password" class="form-control" id="password" name="password">
                        <small class="form-text text-muted">Leave blank if you don't want to change the password</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Level 2 Fields -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">Project Information</div>
            <div class="card-body">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="business_project">Business Project</label>
                        <input type="text" class="form-control" id="business_project" name="business_project" value="{{ user.business_project }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="value_chain_cat">Value Chain Category</label>
                        <input type="text" class="form-control" id="value_chain_cat" name="value_chain_cat" value="{{ user.value_chain_cat }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="borrowing_relationship">Borrowing Relationship</label>
                        <input type="text" class="form-control" id="borrowing_relationship" name="borrowing_relationship" value="{{ user.borrowing_relationship }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="fresh_loan_request">Fresh Loan Request</label>
                        <input type="text" class="form-control" id="fresh_loan_request" name="fresh_loan_request" value="{{ user.fresh_loan_request }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="request_submitted_to_bank">Request Submitted to Bank</label>
                        <input type="text" class="form-control" id="request_submitted_to_bank" name="request_submitted_to_bank" value="{{ user.request_submitted_to_bank }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="feasibility_study_available">Feasibility Study Available</label>
                        <input type="text" class="form-control" id="feasibility_study_available" name="feasibility_study_available" value="{{ user.feasibility_study_available }}">
                    </div>
                </div>
                <div class="form-group">
                    <label for="proposed_facility_amount">Proposed Facility Amount</label>
                    <input type="number" class="form-control" id="proposed_facility_amount" name="proposed_facility_amount" value="{{ user.proposed_facility_amount }}">
                </div>
            </div>
        </div>
         <!-- Level 3 Fields -->
         <div class="card mb-4">
            <div class="card-header bg-primary text-white">Facility Information</div>
            <div class="card-body">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="purpose_of_facility">Purpose of Facility</label>
                        <input type="text" class="form-control" id="purpose_of_facility" name="purpose_of_facility" value="{{ user.PURPOSE_OF_FACILITY }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="name_of_bank">Name of Bank</label>
                        <input type="text" class="form-control" id="name_of_bank" name="name_of_bank" value="{{ user.NAME_OF_BANK }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="security_proposed">Security Proposed</label>
                        <input type="text" class="form-control" id="security_proposed" name="security_proposed" value="{{ user.SECURITY_PROPOSED }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="highlights_of_discussion">Highlights of Discussion</label>
                        <textarea class="form-control" id="highlights_of_discussion" name="highlights_of_discussion">{{ user.HIGHLIGHTS_OF_DISCUSSION }}</textarea>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="rm_bm_name_phone_number">RM/BM Name Phone Number</label>
                        <input type="text" class="form-control" id="rm_bm_name_phone_number" name="rm_bm_name_phone_number" value="{{ user.RM_BM_NAME_PHONE_NUMBER }}">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="rm_bm_email">RM/BM Email</label>
                        <input type="email" class="form-control" id="rm_bm_email" name="rm_bm_email" value="{{ user.RM_BM_EMAIL }}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="status_update">Status Update</label>
                        <textarea class="form-control" id="status_update" name="status_update">{{ user.STATUS_UPDATE }}</textarea>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="challenges">Challenges</label>
                        <textarea class="form-control" id="challenges" name="challenges">{{ user.CHALLENGES }}</textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="proposed_next_steps">Proposed Next Steps</label>
                    <textarea class="form-control" id="proposed_next_steps" name="proposed_next_steps">{{ user.PROPOSED_NEXT_STEPS }}</textarea>
                </div>
            </div>
        </div>


        <div class="text-center">
            <button type="submit" class="btn btn-primary btn-lg">Update</button>
        </div>
    </form>
</div>
{% endblock %}
